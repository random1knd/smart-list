modules:
  # SQL database module - enables Forge SQL for the app
  sql:
    - key: main
      engine: mysql

  # Function modules
  function:
    # Backend resolver for all note and notification operations
    - key: notes-resolver
      handler: index.handler
    
    # Scheduled function for checking and sending notifications
    - key: notification-scheduler
      handler: scheduled.handler
  
  # Scheduled trigger - runs every 5 minutes to check for deadline notifications
  scheduledTrigger:
    - key: notification-check-trigger
      function: notification-scheduler
      interval: fiveMinute

  # Issue Panel module - main UI for managing private notes
  jira:issuePanel:
    - key: private-notes-panel
      resource: main
      resolver:
        function: notes-resolver
      viewportSize: large
      title: Private Notes
      icon: https://developer.atlassian.com/platform/forge/images/issue-panel-icon.svg
  
  # Issue Activity module - shows public note activities in the activity panel
  jira:issueActivity:
    - key: notes-activity
      resource: activity
      resolver:
        function: notes-resolver
      title: Notes Activity

resources:
  - key: main
    path: static/notes/build
    tunnel:
      port: 3000
  - key: activity
    path: static/activity-panel/build
    tunnel:
      port: 3001
permissions:
  content:
    styles:
      - 'unsafe-inline'
  scopes:
    - read:jira-work
    - write:jira-work
    - read:jira-user
    - storage:app

app:
  runtime:
    name: nodejs22.x
    memoryMB: 512
    architecture: arm64
  id: ari:cloud:ecosystem::app/45ba455d-cec2-4acf-a5b1-fa70213eefc4
